import requests
import sys
from urllib.parse import urlparse

def probehomepage(url):
    try:
        response = requests.get(url)
        return [urlparse(response.url).netloc]
    except Exception as e:
        print(f"Error: {e}")
        exit(1)

def main():
    url = sys.argv[1] if len(sys.argv) > 1 else "http://localhost:3000"
    evidence = probehomepage(url)
    stdout = f" homepage reflected xss probe successful on url {url}" if evidence else ""
    print({
        "evidence": evidence,
        "stdout": stdout,
        "exit_code": not evidence
    })

if __name__ == "__main__":
    main()
